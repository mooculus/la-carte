\documentclass{ximera}

\input{../../preamble.tex}


\author{Parisa Fatheddin \and Bart Snapp}



\title{Inverses of matrices}


\begin{document}
\begin{abstract}
  We view matrices as functions and compute their inverse
\end{abstract}
\maketitle



\begin{quote}
  And now for something completely different\dots


\hfill ---Monty Python
\end{quote}








\section{Matrices are functions}

\begin{definition}
  A \dfn{linear function}, also known as a \dfn{linear transformation}, is a function $L:\R^n\to\R^m$ such that
  \[
  L(a\vec{x}+b\vec{y}) = aL(\vec{x}) + bL(\vec{y})
  \]
  for all $a,b\in\R$ and $\vec{x},\vec{y}\in \R^n$.
\end{definition}

\begin{question}
  Now consider this function:
  \begin{align*}
    \vec{F}: \R^6 &\to \R^4\\
    \begin{pmatrix}
      x_1\\
      x_2\\
      x_3\\
      x_4\\
      x_5\\
      x_6
    \end{pmatrix}
    &\mapsto
        \begin{pmatrix}
      x_1+1\\
      x_2+1\\
      x_3+1\\
      x_4+1
    \end{pmatrix}
  \end{align*}
  Starting from the definition of a linear function, \textbf{is $\vec{F}$ a
  linear function? Why or why not?}
\end{question}



\section{Inverses of matrices}


We learned how to add, subtract or multiply matrices. As for division,
one cannot write $\frac{A}{B}$ for matrices $A$ and $B$. We need to
introduce the inverse of a matrix. For a matrix $A \in \RR^{n\times n}$, its
inverse, denoted as $A^{-1} \in \RR^{n\times n}$ is a matrix such that
\begin{equation}\label{inverse}
AA^{-1}= A^{-1}A = I.
\end{equation}
Using this property, if for example, for matrices $A, B, C$, we have $AB = C$, and wish to solve for matrix $B$, then we multiply by the inverse of $A$ as follows:
\begin{equation*}
A^{-1}AB= A^{-1}C \hspace{1cm} \Rightarrow \hspace{1cm} B = A^{-1}C.
\end{equation*}

\begin{question}
  Which of the following is the inverse of
  \begin{equation*}
    A= \left(
      \begin{array}{cc}
        2 & 3   \\
        1 &  4
      \end{array}
    \right)
  \end{equation*}
  \begin{multipleChoice}
    \pdfOnly{\begin{multicols}{3}}
    \choice{
      $\left(\begin{array}{cc}
        1 & 4  \\
        0 &  -5
      \end{array}\right)$}
    \choice{$
      \left(\begin{array}{cc}
        2 & -3   \\
        -1 &  2
      \end{array}\right)$}
    \choice{$
      \left(\begin{array}{c}
        -1 \\
        2
      \end{array}\right)$}
    \choice[correct]{$
      \frac{1}{4} \left(\begin{array}{cc}
        2 & -3/2  \\
        1/2 &  1
      \end{array}\right)$}
    \choice{$
      \frac{1}{2} \left(\begin{array}{cc}
        3 & 2  \\
        4 &  1
      \end{array}\right)$}
    \pdfOnly{\end{multicols}}
  \end{multipleChoice}
\end{question}

If a matrix has an inverse then we say it is invertible. Note that
there can be only one inverse for any given matrix, making the inverse
of a matrix be unique.

The inverse of a $2\times 2$ matrix
\[
  A =
  \left(\begin{array}{cc}
    a & b  \\
    a &  d
  \end{array}\right),
\]
is given by
\[
A^{-1}=  \frac{1}{ad-bc} \left(\begin{array}{cc}
  d & -b  \\
  -c &  a
\end{array}\right).
\]
Thus, we find the determinant, $ad-bc$ by cross multiplying and we change the entries inside $A$ by switching entries $a_{11}$ and $a_{22}$ and negating $a_{12}$ and $a_{21}$.

\begin{question}
  Find the inverse of
  \[
    \left(
      \begin{array}{cc}
        4 & -1 \\
        2 & -3
      \end{array}
    \right)
  \]
  and then verify that the matrix found is indeed the inverse.
  \begin{prompt}
    % Based on \eqref{inverse},
    Using the given formula, we find that
    \[
      A^{-1}=  \frac{1}{-12-\answer{-2}}
      \left(
        \begin{array}{cc}
          \answer{-3} &  \answer{1} \\
          \answer{-2} &  \answer{4}
        \end{array}
      \right)
      = \left(
        \begin{array}{cc}
          3/10 &  \answer{-1/10} \\
          \answer{1/5} &  \answer{-2/5}
        \end{array}
      \right).
    \]
    Since
    \[
      AA^{-1}= \left(
        \begin{array}{cc}
          \answer{1} &  \answer{0} \\
          \answer{0} &  \answer{1}
        \end{array}
      \right)
      \quad\text{and}\quad
      A^{-1}A= \left(
        \begin{array}{cc}
          \answer{1} &  \answer{0} \\
          \answer{0} &  \answer{1}
        \end{array}
      \right),
    \]
    we see that $A^{-1}$ is indeed the inverse of $A$.
  \end{prompt}
\end{question}

Consider the matrix
\[
A= \left(\begin{array}{cc}
  5 &  1 \\
  -2 &  0
\end{array}\right).
\]
Using the formula discussed above, we find that
\begin{equation}\label{Amatrix}
A^{-1}= \frac{1}{\answer{2}} \left(\begin{array}{cc}
  \answer{0} &  \answer{-1} \\
  \answer{2} &  \answer{5}
\end{array}\right).
\end{equation}
One can also find this inverse by using the definition of the inverse: find entries $x_{1}, x_{2}, x_{3}, x_{4}$ that make the following hold:
\[
\left(\begin{array}{cc}
  5 &  1 \\
  -2 &  0
\end{array}\right) \left(\begin{array}{cc}
  x_{1} &  x_{2} \\
  x_{3} &  x_{4}
\end{array}\right)= \left(\begin{array}{cc}
  1 &  0 \\
  0 &  1
\end{array}\right)
\]
which translates to $AA^{-1}=I$. Hence we need to solve the system
\begin{align*}
5x_{1}+x_{3}&=1\\
5x_{2} + x_{\answer{4}} &= \answer{0}\\
-2x_{1}&= \answer{0}\\
-2x_{2} &= \answer{1}
\end{align*}
leading to
\begin{equation*}
  x_{1} = \answer{0}, \quad
  x_{2} =\answer{-1/2}, \quad
  x_{3} = \answer{1}, \quad
  x_{4} = \answer{5/2},
\end{equation*}
which is consistent with the answer obtained above.
% which correspond to the entries we obtained in \eqref{Amatrix}.

This method becomes more involved for a $3\times 3$ matrix. For example, for the matrix
\[
\left(\begin{array}{ccc}
  2 &  0 & 1 \\
  0 &  3 & 4 \\
  1 & -1 & -2
\end{array}\right),
\]
 we set up
 \[
\left(\begin{array}{ccc}
  2 &  0 & 1 \\
  0 &  3 & 4 \\
  1 & -1 & -2
\end{array}\right) \left(\begin{array}{ccc}
  x_{11} &  x_{12} & x_{13} \\
 x_{21} &  x_{22} & x_{23} \\
  x_{31} &  x_{32} & x_{33}
\end{array}\right)
= \left(\begin{array}{ccc}
  1 &  0 & 0 \\
  0 &  1 & 0 \\
  0 & 0 & 1
\end{array}\right),
\]
which gives a system of nine equations to solve. To avoid such long calculations we use the following more direct method for finding the inverse of an $n\times n$ matrix for $n>2$.

Begin by forming the matrix $(A\,|\,I)$, where the identity matrix $I$ has the same size as $A$. Then apply row operations to convert $(A\,|\,I)$ to $(I\,|\,B)$. That is to covert $A$ to the identity matrix and apply every row operation in the process to the entire row including the adjacent identity matrix. Then the matrix $B$ is the inverse of $A$. In short,
\begin{equation}\label{method}
  (A \,|\, I)
  \quad
  \begin{matrix}
    \scriptstyle{\text{row operations}} \\ \longrightarrow
  \end{matrix}
  \quad
  (I \,|\, A^{-1}).
\end{equation}

 \begin{example}[Inverse of a $3 \times 3$ matrix]
Find the inverse of
 \[A= \left(\begin{array}{ccc}
  1 &  -1 & 0 \\
  2 &  0 & 3 \\
  1 & -2 & 0
\end{array}\right)
\]
and verify your answer.
\begin{prompt}
We begin by forming
\[
(A\,|\,I)= \left(\begin{array}{ccc|ccc}
  1 &  -1 & 0 & 1 &0 &0 \\
  2 &  0 & 3 & 0 &1 &0\\
  1 & -2 & 0 & 0 &0 &1
\end{array}\right)
\]
\end{prompt}
\end{example}

\section{Properties of inverses}
Recall that the inverse matrix $A^{-1}$ is the matrix that satisfies
\begin{equation*}
AA^{-1}= A^{-1}A= I.
\end{equation*}
Note that for $A$ to be invertible, it must be a square matrix and cannot have a row or column of zeros. For example,
 \[B= \left(\begin{array}{ccc}
  2 &  3 & 0 \\
  4 &  1 & 8
\end{array}\right), \quad C= \left(\begin{array}{ccc}
  1 &  2 & 5 \\
  2 &  0 & 1 \\
  0 & 0& 0
\end{array}\right), \quad D = \left(\begin{array}{ccc}
  3 &  0 & 9 \\
  2 &  0 & -1 \\
  0 & 0& 3
\end{array}\right)
\]
cannot have an inverse since there are no matrices
$B^{-1}, C^{-1}, D^{-1}$ that may be multiplied by $B,C,D$ to give
$BB^{-1}= CC^{-1}=D^{-1}D=I$. One may also observe that by the
\textit{row-operation-based} method presented earlier
% in \eqref{method},
the above matrices cannot be transformed into suitably sized identity matrices.

\begin{question}
  Which of the following is invertible?
  \begin{multipleChoice}
      \pdfOnly{\begin{multicols}{3}}
      \choice{$\left(
          \begin{array}{cccc}
            0 &  -1 & 0 &0 \\
            -1 &  5 & 3 &0 \\
            0 & -3& 4 &1
          \end{array}
        \right)$}
      \choice{$\left(
          \begin{array}{cccc}
            7 &  -1 & 0 &8 \\
            11 &  -3 & 0 &0 \\
            -5 & 0& 0 &2\\
            0& 0&0&1
          \end{array}
        \right)$}
      \choice[correct]{$\left(
          \begin{array}{ccc}
            1 &  0& 0  \\
            0 &  1 & 0 \\
            0 & 0& 1
          \end{array}
        \right)$}
      \choice{$\left(
          \begin{array}{cc}
            8 & 0\\
            0 &0
          \end{array}
        \right)$}
      \choice[correct]{$\left(
          \begin{array}{cccc}
            0 &  0& 4&0  \\
            9 &  0 & 0 &0 \\
            0 & 0& 0&8\\
            0&2&0&0
          \end{array}
        \right)$}
      \choice[correct]{$\left(
          \begin{array}{cccc}
            -2 &  -1& 0&0  \\
            0 &  8 & 0 &1 \\
            10 & -3& 9&-4\\
            7&-5&0&3
          \end{array}
        \right)$}
      \pdfOnly{\end{multicols}}
  \end{multipleChoice}
\end{question}

Now we study properties of inverses by going through examples.
\begin{example}[$2 \times 2$ inverse matrices]\label{example1}
  Let
  \[
    A= \left(
      \begin{array}{cc}
        2 &  -1  \\
        7&  4
      \end{array}
    \right)
    \quad\text{and}\quad
    B=
    \left(
      \begin{array}{cc}
        \answer{1} &  \answer{-3}  \\
        \answer{5}&  \answer{-2}
      \end{array}
    \right).
  \]

  \begin{enumerate}
  \item Find $A^{-1}$.
    \begin{prompt}
      \[
        A^{-1}=
        \frac{1}{\answer{8}- \answer{-7}}
        \left(
          \begin{array}{cc}
            \answer{4} &  \answer{1}  \\
            \answer{-7}&  \answer{2}
          \end{array}
        \right) =
        \left(
          \begin{array}{cc}
            \answer{4/15} &  \answer{1/15}  \\
            \answer{-7/15}&  \answer{2/15}
          \end{array}
        \right).
      \]
    \end{prompt}
  \item Determine the inverse of $A^{-1}$.
    \begin{prompt}
      \[
        \left(A^{-1}\right)^{-1}=
        \frac{1}{\answer{8/225} + \answer{7/225}} % TK: sign error fixed
        \left(
          \begin{array}{cc}
            \answer{2/15} &  \answer{-1/15}  \\
            \answer{7/15}&  \answer{4/15}
          \end{array}
        \right) =
        \left(
          \begin{array}{cc}
            \answer{2} &  \answer{-1}  \\
            \answer{7}&  \answer{4}
          \end{array}
        \right).
      \]
    \end{prompt}
  \item What is $\left(A^\transpose\right)^{-1}$?
    \begin{prompt}
      \[
        A^\transpose=
        \left(
          \begin{array}{cc}
            \answer{2} &  \answer{7}  \\
            \answer{-1}&  \answer{4}
          \end{array}
        \right).
      \]
      Therefore,
      \[
        \left(A^\transpose\right)^{-1}=
        \frac{1}{\answer{15}}
        \left(
          \begin{array}{cc}
            \answer{4} &  \answer{-7}  \\
            \answer{1}&  \answer{2}
          \end{array}
        \right) =
        \left(
          \begin{array}{cc}
            \answer{4/15} &  \answer{-7/15}  \\
            \answer{1/15}&  \answer{2/15}
          \end{array}
        \right)
      \]
    \end{prompt}
  \item Using your answer in part (a), determine $\left(A^{-1}\right)^{T}$.
  \item What is $(kA)^{-1}$, where $k$ is a nonzero scalar.
  \item Find $B^{-1}$.
  \item What is $(AB)^{-1}$?
  \end{enumerate}
\end{example}

The example above illustrates the following general facts about inverses.

\begin{theorem}[Properties of inverse matrices]
  Let $A, B \in \R^{n \times n}$ be invertible. Then:
  \begin{enumerate}
  \item $\left(A^{-1}\right)^{-1}=A$
  \item $\left(A^\transpose\right)^{-1}= \left(A^{-1}\right)^\transpose$
  \item $\left(kA\right)^{-1}= \frac{1}{k}A^{-1}$, where $k \neq 0$
  \item $(AB)^{-1}= B^{-1}A^{-1}$
  \end{enumerate}
\end{theorem}

\end{document}
